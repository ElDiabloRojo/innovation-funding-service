<!DOCTYPE html>
<html lang="en" class="govuk-template" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Project team'" />
</head>
<body class="govuk-template__body">

<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />

<div class="govuk-width-container">
    <th:block th:insert="fragments/layout :: phase-banner" />
    <th:block th:insert="fragments/layout :: header-sub" th:with="linkTitle='Set up your project',linkUrl=@{/project/{id}(id=${model.projectId})}" />

    <main class="govuk-main-wrapper" id="main-content" role="main">
        <th:block th:insert="fragments/layout :: page-title" th:with="pageTitle='Project team',subTitle=${model.projectName},size='govuk-heading-xl'" />

        <p class="govuk-body">The lead partner must choose a project manager who will be responsible for setting up the
            project. Each partner must provide a finance contact. We will contact the assigned person with any finance
            queries.</p>
        <p class="govuk-body">Everyone below can view all of project setup. If you add a new person they will show as
            pending until they register for the website. Once they register you can assign them a role.</p>

        <table class="govuk-table">
            <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                    <th scope="col" class="govuk-table__header larger-cols"><span class="govuk-visually-hidden">Role</span></th>
                    <th scope="col" class="govuk-table__header"><span class="govuk-visually-hidden">Name</span></th>
                    <th scope="col" class="govuk-table__header smaller-col"><span class="govuk-visually-hidden">Status</span></th>
                </tr>
            </thead>
            <tbody class="govuk-table__body">
                <tr th:if="${model.userLeadPartner}"
                    class="govuk-table__row">
                    <td class="govuk-table__cell govuk-!-width-one-half">
                        <a th:unless="${model.grantOfferLetterGenerated}"
                           th:href="@{/project/{id}/details/project-manager(id=${model.projectId})}" class="govuk-link">Project manager</a>
                        <th:block th:if="${model.grantOfferLetterGenerated}">Project manager</th:block>
                    </td>
                    <td class="govuk-table__cell govuk-!-width-one-quarter"
                        th:text="${model.projectManager != null ? model.projectManager?.userName : '-'}">
                    </td>
                    <td class="govuk-table__cell govuk-!-width-one-quarter govuk-table__cell--numeric">
                        <strong th:if="${model.projectManager == null}" class="incomplete">Incomplete</strong>
                        <strong th:unless="${model.projectManager == null}" class="complete">Complete</strong>
                    </td>
                </tr>
                <!--<tr class="govuk-table__row">-->
                    <!--<td class="govuk-table__cell">-->
                        <!--<a th:href="@{/project/{id}/details/finance-contact?organisation={organisationId}(id=${model.project.getId()},organisationId=${organisation.id})}" class="govuk-link">Your finance contact</a>-->
                    <!--</td>-->
                    <!--<td class="govuk-table__cell"-->
                        <!--th:text="${model.getFinanceContactForPartnerOrganisation(organisation.id) != null ? model.getFinanceContactForPartnerOrganisation(organisation.id).userName : '-'}">-->
                    <!--</td>-->
                    <!--<td class="govuk-table__cell govuk-table__cell&#45;&#45;numeric">-->
                        <!--<strong th:if="${model.getFinanceContactForPartnerOrganisation(organisation.id) == null}" class="incomplete">Incomplete</strong>-->
                        <!--<strong th:unless="${model.getFinanceContactForPartnerOrganisation(organisation.id) == null}" class="complete">Complete</strong>-->
                    <!--</td>-->
                <!--</tr>-->
            </tbody>
        </table>

        <th:block th:each="organisation: ${model.organisations}">
            <h2 class="govuk-heading-m govuk-!-margin-bottom-0">
                <th:block th:text="${organisation.name}"></th:block>
                <th:block th:if="${organisation.name.equals(model.leadOrganisation.name)}">(Lead)</th:block>
            </h2>
            <table th:classappend="${model.isUserPartnerInOrganisation(organisation.id) and !model.isReadOnly() and !model.grantOfferLetterGenerated} ? 'govuk-!-margin-bottom-2'"
                   class="govuk-table">
                <thead class="govuk-table__head">
                    <tr class="govuk-table__row">
                        <th scope="col" class="govuk-table__header larger-cols">Name</th>
                        <th scope="col" class="govuk-table__header">Role</th>
                        <th scope="col" class="govuk-table__header smaller-col"><span class="govuk-visually-hidden">Remove</span></th>
                    </tr>
                </thead>
                <tbody class="govuk-table__body govuk-!-margin-bottom-2">
                    <tr th:each="applicant : ${organisation.applicants}"
                         class="govuk-table__row">
                        <td class="govuk-table__cell govuk-!-width-one-half" th:text="${applicant.name}"></td>
                        <td class="govuk-table__cell govuk-!-width-one-quarter">-</td>
                        <td class="govuk-table__cell govuk-!-width-one-quarter govuk-table__cell--numeric">
                            <a href="/" class="govuk-link">Remove</a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p th:if="${model.isUserPartnerInOrganisation(organisation.id) and !model.isReadOnly() and !model.grantOfferLetterGenerated}"
               class="govuk-body"><a href="/" class="govuk-link">+ Add team member</a></p>
        </th:block>

        <a th:href="@{/project/{id}(id=${model.project.getId()})}" class="button-secondary">Return to setup your project</a>

        <th:block th:insert="fragments/layout :: main-content-end" />
    </main>
</div>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
<th:block th:insert="fragments/service-layout :: body-end" />

</body>
</html>


<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Application Dashboard'" />
    <link href="/css/prototype.css" media="screen" rel="stylesheet" type="text/css" />

</head>

<body>

<th:block th:insert="prototypes/fragments/layout :: prototype-nav" />
<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />


<main id="content">


    <th:block th:insert="prototypes/fragments/applicant-view :: prototype-subheader(${'Finance checks'}, ${'/prototypes/5163-project-finances'})" />

	<!-- HARDCODED PROTOTYPE HTML -->

  <th:block th:insert="prototypes/fragments/comp-admin :: prototype-comp-admin-page-title-subheading(${'0102469: Solving problems with data'}, ${'Eligibility'}, ${'project setup'})" />

  <h2 class="govuk-heading-m">10294856: Novel bioreactor design for fermentation of syngas to industrially relevant chemicals</h2>

  <h3 class="govuk-heading-l govuk-!-margin-0">Aptrans Ltd <small>(Lead partner)</small></h3>

	<!-- <th:block th:insert="prototypes/fragments/comp-admin :: prototype-comp-navigation" th:with="page='project-setup', status='closed'" /> -->

	<th:block th:if="${param.status != null and param.status[0] == 'approved'}">
		<div class="success-alert">
			The partner finance eligibility has been approved by Paul Davidson, 27 July 2016
		</div>
	</th:block>


	<th:block th:if="${param.status != null and param.status[0] == 'grantChanged' or param.action != null and param.action[0] == 'grantChanged'}">
		<div class="govuk-body panel">
			<h3 class="govuk-heading-m govuk-!-margin-top-0">% Grant has been reduced from 55% to 40% </h3>
			<dl class="standard-definition-list">
				<dt>Funding sought</dt>
				<dd>&pound;180,399</dd>

				<dt>Funding granted</dt>
				<dd>&pound;160,000</dd>
			</dl>
		</div>
	</th:block>

	<form>

		<h3 class="govuk-heading-m">Project finances</h3>

		<p class="govuk-body">These finances where originally submitted at the application stage. All saved changes to the finances will be viewable by the applicants.</p>

		<p class="govuk-body"><a href="#">project-costs.csv</a></p>

		<h3 class="govuk-heading-m">Finance contact</h3>

		<p class="govuk-body">Dave Norman <br /><a href="mailto:#">dave@norman.com</a></p>

		<!-- <a href="/prototypes/1581-changes-finances">Review all changes to project finances</a> -->

	    <h3 class="govuk-heading-m">Project costs</h3>

	    <p class="govuk-body">Please enter final project costs below</p>

	    <table class="govuk-table">
	    	<thead class="govuk-table__head">
	    		<tr class="govuk-table__row">
	    			<th scope="col" class="govuk-heading-s">Section</th>
	    			<th scope="col" class="govuk-heading-s alignright" id="project-cost">Project costs</th>
	    		</tr>
	    	</thead>
	    	<tfoot>
	    		<tr class="govuk-table__row">
	    			<th scope="col" class="govuk-heading-s">
	    				Total project costs
	    			</th>
	    			<td class="govuk-heading-s alignright" th:unless="${param.status != null and param.status[0] == 'approved'}">
	    				&pound;20,0000
	    			</td>
	    			<td class="govuk-heading-s alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">
	    				&pound;70,000
	    			</td>
	    		</tr>
	    	</tfoot>
	    	<tbody class="govuk-table__body">
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="labour">Labour</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" value="&pound;20,000" aria-labelledby="project-cost labour"/></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;8,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="admin-support-costs">Administration support costs</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost admin-support-costs" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;2,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="materials">Materials</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost materials" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;10,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="capital-usage">Capital usage</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost capital-usage" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;10,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="subcontracting-costs">Subcontracting costs</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost subcontracting-costs" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;10,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="travel-subsistence">Travel and subsistence</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost travel-subsistence" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;10,000</td>
	    		</tr>
	    		<tr class="govuk-table__row">
	    			<th scope="col" id="other-costs">Other costs</th>
	    			<td class="alignright" th:unless="${param.status != null and param.status[0] == 'approved'}"><input type="text" class="govuk-input alignright" aria-labelledby="project-cost other-costs" /></td>
	    			<td class="alignright" th:unless="${param.status == null or param.status[0] != 'approved'}">&pound;10,000</td>
	    		</tr>
	    	</tbody>
	    </table>

	  <!--   <div class="extra-margin">
	    	<a href="/prototypes/3807-finance-queries" class="govuk-button button-secondary">Queries</a>
	    	<a href="/prototypes/3990-finance-notes" class="govuk-button button-secondary">Notes</a>
	    </div> -->


		<th:block th:unless="${param.status != null and param.status[0] == 'approved'}">

		    <h3 class="govuk-heading-m">Approve eligible costs</h3>
		    <p class="govuk-body">After any required alterations have been made, eligible costs should be approved.</p>
		    <p class="govuk-body">If changes are made ensure that the applicant has reviewed and understand the changes to their finances before approval.</p>

		    <div class="govuk-form-group">
		    	<label class="block-label selection-button-checkbox" for="costs-reviewed">
			      <input id="costs-reviewed" value="costs-reviewed" type="checkbox" />
			     	These finances have been reviewed and are eligible for this project
			    </label>
		    </div>

		    <div class="govuk-form-group hidden" id="add-rag-rating">
                <label for="rag-rating" class="form-label">Please enter the RAG rating for this eligibility review</label>
                <select id="rag-rating" name="rag-rating" class="govuk-select" >
                	<option value="">--</option>
                	<option value="Green">Green</option>
                	<option value="Amber">Amber</option>
                	<option value="Red">Red</option>
                </select>
            </div>

	    	<button data-js-modal="approve-eligibility-modal" id="approve-eligibility" class="govuk-button" type="submit" disabled="disabled">Approve eligible costs</button>

		    <div class="approve-eligibility-modal" role="dialog" aria-hidden="true" style="margin-top: -174px;">
		        <button class="js-close close" aria-label="Close Popup">X</button>
		        <div>

					<h2 class="govuk-heading-m govuk-!-margin-0">Approve eligible costs</h2>

					<p class="govuk-body">This partner will now be marked as eligible for this project.</p>

					<form>

						<hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible" />

			        	<div class="alignright-button">

							<a href="#" aria-label="Close Popup" class="govuk-button-link js-close">Cancel</a>

							<input type="hidden" id="action" name="action" th:value="${(param.status != null and param.status[0] == 'grantChanged' ? 'grantChanged' : '')}" />
							<input type="hidden" id="status" name="status" value="approved" />

			        		<button class="govuk-button" th:formaction="@{${#httpServletRequest.requestURI}}">Approve eligible costs</button>
			        	</div>

			        </form>

		        </div>
		    </div>

		</th:block>

	</form>

	<hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible" />

	<div class="extra-margin">
		<a href="/prototypes/5163-project-finances" class="govuk-button button-secondary" th:text="${(param.status != null and param.status[0] == 'approved'? 'Return to finance checks' : 'Save and return to finance checks')}">RETURN BUTTON TEXT</a>
	</div>

	<!-- END OFHARDCODED PROTOTYPE HTML -->

    <th:block th:insert="fragments/layout :: main-content-end" />
</main>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
<script src="/js/ifs_prototype/jquery.waypoints.min.js" type="text/javascript"></script>
<script src="/js/ifs_prototype/prototype.js" type="text/javascript"></script>
<script type="text/javascript">
	// <![CDATA[
	jQuery('input#costs-reviewed').on('click',function(e){
		if ( jQuery(this).is(':checked') ) {
			jQuery("#approve-eligibility").removeAttr('disabled');
		}else{
			jQuery("#approve-eligibility").addAttr('disabled');
		}
	});


	// ]]>
</script>
</body>
</html>
